# 尽量不适用终结方法和清除方法

---

## 场景

~~~text
1. 结果是不可预测和危险的,一般情况下是不必要的
2.性能开销大
3.出现的类对等体可能被攻击去调用一些本来无法被调用的问题
4.因为不稳定性所以这些方法本身是不应该被依赖的


所以,如果真的存在线程和资源需要close呢
只需要让类实现AutoCloseAble方法.并要求客户端在每个实例不在需要的时候调用close方法.
一般使用try-with-resource确保终止

使用终结方法和清除方法的好处:
1.当用户或者使用者忘记清除资源的时候,充当资源清除的过滤网
2.对象在本地还有一个非java的nativeObject,如果想要垃圾回收器发现这个对象
需要通过终结方法或者清除方法让垃圾回收器发现这些
~~~

## 示例
~~~java
import sun.misc.Cleaner;

public class Room implements AutoCloseable{

    private static final Cleaner cleaner = null;

    private static class State implements Runnable{

        int numJunkPiles;

        public State(int numJunkPiles) {
            this.numJunkPiles = numJunkPiles;
        }

        @Override
        public void run() {
            System.out.println("Clear Room");
            numJunkPiles = 0;
        }
    }

    // 相关代码无法复制,因为演示的例子是java 9开始的一个类
   /* private final State state;

    private final cleanable*/
    @Override
    public void close() throws Exception {

    }
}
~~~
