# 关于一个特殊的按位与的情况



~~~text
x % 2的n次方 = x & (2的n次方 - 1)
~~~

> 关键信息归纳
>
> 第一个是取余
>
> 第二个书按位与,按位与遵循规则1+1=1别的都得0
>
> 按位与的其中一个功能就是消除其他位获取想得到的位
>
> 比如想获取从下往上的x位,就和一个从下往上到x都是1的二进制数进行按位与,则别的位本身就不是1则消除了

比如

~~~text
1 0 0 1 1 1 0
0 0 0 1 1 1 0
--------------
0 0 0 1 1 1 0
如上就获取了的后四位
~~~

那从左边看, 假设余数是k , 则 x  = 2^n + k 

这时候的k是什么

假设x是一个二进制的数字,那么,2^n表示的也就是x的最高位

如果把x的最高位消除了,剩下的就是余数

比如

~~~text
假设x是9
则9 = 8 + 1 (2的3次方 + 2的0次方)
二进制表示是
1001
所以这里就是消除最高位就是余数
可以通过按位与的方式消除最高位

1 0 0 1
0 1 1 1
--------
0 0 0 1
可得余数的二进制形式是0 0 0 1也就是十进制的1
~~~

也就是说

~~~text
我们如果想通过按位与获取余数,需要提供一个除了最高位别的位都是1的一个二进制数字q
也就是造出来这个数字就好
这时候就可以借助2^n来实现这个q
2^n表示的就是一个最高位是1别的位全是0的二进制数字
比如2^3是8,
二进制
1000
~~~

已知

二进制的减法

~~~text
规则是向上一位借位,借位的数字 -1 ,然后当前位置+2再去减去下面的数

比如

1  0  0  1  0  1  0
1  0  0  0  1  1  1
-------------------
最后一位是0 - 1不够位,向上借1,再+2,上位欠了1,当前位是(0 +2 ) -1 = 1
1  0  0  1  0  -1  0
1  0  0  0  1  1   1
--------------------
                   1
同理一步一步往后往前计算

~~~

这时候可以实现一个操作

通过2n-1来实现这个二进制数字Q

~~~text
1   0   0   ...   0   0   0
0   0   0   ...   0   0   1
---------------------------
可知最后一位是0+2-1是1
倒数第二位是0被借位,0-1,是-1不够位,继续向上接1,则0-1+2-0 = 1
同理,一直到最高位的前一位都是1
最高位被借了1 则 1-1-0等于0
则最后的结果位

1   0   0   ...   0   0   0
0   0   0   ...   0   0   1
---------------------------
0   1   1   ...   1   1   1

那么我们的q实现了!
这时候通过k来按位与我们的q就可以得到余数
也就是k & (2^n -1)
~~~

